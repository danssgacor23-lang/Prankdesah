<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Autoplay Full Volume</title>
  <style>
    html,body{height:100%;margin:0;font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial}
    .center{display:flex;align-items:center;justify-content:center;height:100%;flex-direction:column}
    .big-btn{padding:18px 28px;border-radius:12px;border:0;font-size:18px;cursor:pointer}
    #overlay{position:fixed;inset:0;background:rgba(0,0,0,0.75);color:#fff;display:flex;align-items:center;justify-content:center;flex-direction:column;z-index:999}
    #overlay.hidden{display:none}
    .muted-note{opacity:0.9;font-size:14px;margin-top:12px}
  </style>
</head>
<body>
  <div class="center">
    <h1>Halaman Autoplay Suara (Full Volume)</h1>
    <p>Jika browser mengizinkan autoplay, suara akan diputar otomatis pada volume maksimal.</p>
  </div>

  <!-- Ganti src dengan file audio Anda (mp3/ogg). Bisa juga URL remote. -->
  <audio id="bgAudio" loop playsinline preload="auto">
    <source src="https://danssgacor23-lang.github.io/ahaudio/prank.mp3" type="audio/mpeg">
    Your browser does not support the audio element.
  </audio>

  <!-- Overlay fallback untuk browser yang memblokir autoplay suara -->
  <div id="overlay">
    <div style="text-align:center;max-width:90%">
      <h2>Tap untuk mengaktifkan suara</h2>
      <p class="muted-note">Browser mungkin memblokir autoplay suara. Ketuk tombol di bawah untuk mengizinkan suara dan menaikkan volume ke maksimal.</p>
      <button id="enableBtn" class="big-btn">Aktifkan Suara</button>
    </div>
  </div>

  <script>
    const audio = document.getElementById('bgAudio');
    const overlay = document.getElementById('overlay');
    const btn = document.getElementById('enableBtn');

    // Fungsi untuk mencoba autoplay; tidak menjamin berhasil (browser policies).
    async function tryAutoPlay() {
      try {
        // Set volume ke 1.0 (maks) — nilai 0.0 sampai 1.0
        audio.volume = 1.0;

        // Create/resume AudioContext to increase chance audio is allowed on some browser chains
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        if (AudioContext) {
          window._ctx = window._ctx || new AudioContext();
          if (window._ctx.state === 'suspended') {
            // Some browsers start in suspended state until user gesture.
            await window._ctx.resume().catch(()=>{});
          }
          // Connect an Audio element node to the context (optional)
          try {
            const srcNode = window._ctx.createMediaElementSource(audio);
            srcNode.connect(window._ctx.destination);
          } catch(e) {
            // createMediaElementSource can throw if audio already connected — ignore
          }
        }

        await audio.play(); // attempt to play
        // Jika berhasil, sembunyikan overlay
        overlay.classList.add('hidden');
        console.log('Autoplay berhasil — audio diputar.');
      } catch (err) {
        console.warn('Autoplay gagal:', err);
        // Tampilkan overlay supaya user bisa mengetuk untuk mengaktifkan
        overlay.classList.remove('hidden');
      }
    }

    // Coba autoplay saat halaman load
    window.addEventListener('load', ()=>{
      tryAutoPlay();

      // Beberapa browser membolehkan autoplay jika ada short silent play first; coba mainkan pendek tanpa suara
      (async ()=>{
        try {
          const AudioContext = window.AudioContext || window.webkitAudioContext;
          if (AudioContext) {
            window._ctx = window._ctx || new AudioContext();
            if (window._ctx.state === 'suspended') {
              // resume (may fail without gesture)
              await window._ctx.resume().catch(()=>{});
            }
          }
        } catch(e){}
      })();
    });

    // Tombol fallback — pasti akan mengaktifkan audio karena user gesture
    btn.addEventListener('click', async ()=>{
      try {
        // Pastikan audio context resume
        if (window._ctx && window._ctx.state === 'suspended') {
          await window._ctx.resume().catch(()=>{});
        }

        audio.volume = 1.0; // set volume maksimal
        await audio.play();
        overlay.classList.add('hidden');
      } catch(e) {
        console.error('Gagal memutar setelah klik:', e);
        alert('Gagal memutar audio — cek kembali file audio (sample.mp3) atau izin autoplay di browser.');
      }
    });
  </script>
</body>
</html>
